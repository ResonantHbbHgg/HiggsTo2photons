#include <vector>
#include <map>
#include <iostream>

#include "TH1F.h"
#include "TGraph.h"
#include "TCanvas.h"
#include "TString.h"

double GetBR(double mass) {

  map <double, double> BranchingRatioMap;
  BranchingRatioMap[90]=0.00123;
  BranchingRatioMap[95]=0.0014;
  BranchingRatioMap[100]=0.00159;
  BranchingRatioMap[105]=0.00178;
  BranchingRatioMap[110]=0.00197;
  BranchingRatioMap[110.5]=0.00199;
  BranchingRatioMap[111]=0.002;
  BranchingRatioMap[111.5]=0.00202;
  BranchingRatioMap[112]=0.00204;
  BranchingRatioMap[112.5]=0.00205;
  BranchingRatioMap[113]=0.00207;
  BranchingRatioMap[113.5]=0.00209;
  BranchingRatioMap[114]=0.0021;
  BranchingRatioMap[114.5]=0.00212;
  BranchingRatioMap[115]=0.00213;
  BranchingRatioMap[115.5]=0.00215;
  BranchingRatioMap[116]=0.00216;
  BranchingRatioMap[116.5]=0.00217;
  BranchingRatioMap[117]=0.00218;
  BranchingRatioMap[117.5]=0.0022;
  BranchingRatioMap[118]=0.00221;
  BranchingRatioMap[118.5]=0.00222;
  BranchingRatioMap[119]=0.00223;
  BranchingRatioMap[119.5]=0.00224;
  BranchingRatioMap[120]=0.00225;
  BranchingRatioMap[120.5]=0.00226;
  BranchingRatioMap[121]=0.00226;
  BranchingRatioMap[121.5]=0.00227;
  BranchingRatioMap[122]=0.00228;
  BranchingRatioMap[122.5]=0.00228;
  BranchingRatioMap[123]=0.00228;
  BranchingRatioMap[123.5]=0.00229;
  BranchingRatioMap[124]=0.00229;
  BranchingRatioMap[124.5]=0.00229;
  BranchingRatioMap[125]=0.00229;
  BranchingRatioMap[125.5]=0.00229;
  BranchingRatioMap[126]=0.00229;
  BranchingRatioMap[126.5]=0.00229;
  BranchingRatioMap[127]=0.00229;
  BranchingRatioMap[127.5]=0.00229;
  BranchingRatioMap[128]=0.00228;
  BranchingRatioMap[128.5]=0.00228;
  BranchingRatioMap[129]=0.00227;
  BranchingRatioMap[129.5]=0.00227;
  BranchingRatioMap[130]=0.00226;
  BranchingRatioMap[130.5]=0.00225;
  BranchingRatioMap[131]=0.00224;
  BranchingRatioMap[131.5]=0.00223;
  BranchingRatioMap[132]=0.00222;
  BranchingRatioMap[132.5]=0.00221;
  BranchingRatioMap[133]=0.00219;
  BranchingRatioMap[133.5]=0.00218;
  BranchingRatioMap[134]=0.00217;
  BranchingRatioMap[134.5]=0.00215;
  BranchingRatioMap[135]=0.00213;
  BranchingRatioMap[135.5]=0.00212;
  BranchingRatioMap[136]=0.0021;
  BranchingRatioMap[136.5]=0.00208;
  BranchingRatioMap[137]=0.00206;
  BranchingRatioMap[137.5]=0.00204;
  BranchingRatioMap[138]=0.00202;
  BranchingRatioMap[138.5]=0.002;
  BranchingRatioMap[139]=0.00198;
  BranchingRatioMap[139.5]=0.00196;
  BranchingRatioMap[140]=0.00193;
  BranchingRatioMap[141]=0.00189;
  BranchingRatioMap[142]=0.00184;
  BranchingRatioMap[143]=0.00178;
  BranchingRatioMap[144]=0.00173;
  BranchingRatioMap[145]=0.00167;
  BranchingRatioMap[146]=0.00162;
  BranchingRatioMap[147]=0.00156;
  BranchingRatioMap[148]=0.00149;
  BranchingRatioMap[149]=0.00143;
  BranchingRatioMap[150]=0.00136;
  BranchingRatioMap[151]=0.0013;
  BranchingRatioMap[152]=0.00123;
  BranchingRatioMap[153]=0.00115;
  BranchingRatioMap[154]=0.00108;
  BranchingRatioMap[155]=0.000999;
  BranchingRatioMap[156]=0.000914;
  BranchingRatioMap[157]=0.000825;
  BranchingRatioMap[158]=0.000729;
  BranchingRatioMap[159]=0.000628;
  BranchingRatioMap[160]=0.000532;
  BranchingRatioMap[162]=0.00037;
  BranchingRatioMap[164]=0.000259;
  BranchingRatioMap[166]=0.000208;
  BranchingRatioMap[168]=0.000178;
  BranchingRatioMap[170]=0.000158;
  BranchingRatioMap[172]=0.000143;
  BranchingRatioMap[174]=0.000132;
  BranchingRatioMap[176]=0.000122;
  BranchingRatioMap[178]=0.000113;
  BranchingRatioMap[180]=0.000105;
  BranchingRatioMap[182]=0.0000968;
  BranchingRatioMap[184]=0.0000881;
  BranchingRatioMap[186]=0.0000809;
  BranchingRatioMap[188]=0.0000752;
  BranchingRatioMap[190]=0.0000705;
  BranchingRatioMap[192]=0.0000666;
  BranchingRatioMap[194]=0.0000632;
  BranchingRatioMap[196]=0.0000602;
  BranchingRatioMap[198]=0.0000575;
  BranchingRatioMap[200]=0.0000551;
  BranchingRatioMap[202]=0.0000529;
  BranchingRatioMap[204]=0.0000508;
  BranchingRatioMap[206]=0.0000489;
  BranchingRatioMap[208]=0.0000471;
  BranchingRatioMap[210]=0.0000454;
  BranchingRatioMap[212]=0.0000439;
  BranchingRatioMap[214]=0.0000424;
  BranchingRatioMap[216]=0.000041;
  BranchingRatioMap[218]=0.0000396;
  BranchingRatioMap[220]=0.0000384;
  BranchingRatioMap[222]=0.0000372;
  BranchingRatioMap[224]=0.000036;
  BranchingRatioMap[226]=0.0000349;
  BranchingRatioMap[228]=0.0000339;
  BranchingRatioMap[230]=0.0000328;
  BranchingRatioMap[232]=0.0000319;
  BranchingRatioMap[234]=0.0000309;
  BranchingRatioMap[236]=0.0000301;
  BranchingRatioMap[238]=0.0000292;
  BranchingRatioMap[240]=0.0000284;
  BranchingRatioMap[242]=0.0000276;
  BranchingRatioMap[244]=0.0000268;
  BranchingRatioMap[246]=0.0000261;
  BranchingRatioMap[248]=0.0000254;
  BranchingRatioMap[250]=0.0000247;

  for (std::map<double, double>::const_iterator iter = BranchingRatioMap.begin();  iter != BranchingRatioMap.end(); ++iter) {
    if (mass==iter->first) return iter->second;
    if (mass>iter->first) {
      double lowmass = iter->first;
      double lowbr = iter->second;
      ++iter;
      if (mass<iter->first) {
        double highmass = iter->first;
        double highbr = iter->second;
        double br = (highbr-lowbr)/(highmass-lowmass)*(mass-lowmass)+lowbr;
        return br;
      }
      --iter;
    }
  }
  
  std::cout << "Warning branching ratio outside range of 90-250GeV!!!!" << std::endl;
  exit(1);
  
}

double GetXsection(double mass) {

  map <double, double> XSectionMap;
  XSectionMap[90]=33.8959;
  XSectionMap[95]=30.5228;
  XSectionMap[100]=27.5471;
  XSectionMap[105]=24.9582;
  XSectionMap[110]=22.7112;
  XSectionMap[110.5]=22.4929;
  XSectionMap[111]=22.2949;
  XSectionMap[111.5]=22.0882;
  XSectionMap[112]=21.891;
  XSectionMap[112.5]=21.6841;
  XSectionMap[113]=21.4987;
  XSectionMap[113.5]=21.3024;
  XSectionMap[114]=21.1075;
  XSectionMap[114.5]=20.9231;
  XSectionMap[115]=20.7379;
  XSectionMap[115.5]=20.5543;
  XSectionMap[116]=20.3799;
  XSectionMap[116.5]=20.197;
  XSectionMap[117]=20.0243;
  XSectionMap[117.5]=19.851;
  XSectionMap[118]=19.6789;
  XSectionMap[118.5]=19.5072;
  XSectionMap[119]=19.3457;
  XSectionMap[119.5]=19.18438;
  XSectionMap[120]=19.01246;
  XSectionMap[120.5]=18.85166;
  XSectionMap[121]=18.70108;
  XSectionMap[121.5]=18.54062;
  XSectionMap[122]=18.38147;
  XSectionMap[122.5]=18.22164;
  XSectionMap[123]=18.08183;
  XSectionMap[123.5]=17.93234;
  XSectionMap[124]=17.78306;
  XSectionMap[124.5]=17.63389;
  XSectionMap[125]=17.49604;
  XSectionMap[125.5]=17.3472;
  XSectionMap[126]=17.20858;
  XSectionMap[126.5]=17.07017;
  XSectionMap[127]=16.93297;
  XSectionMap[127.5]=16.79489;
  XSectionMap[128]=16.65702;
  XSectionMap[128.5]=16.52027;
  XSectionMap[129]=16.39272;
  XSectionMap[129.5]=16.2553;
  XSectionMap[130]=16.12918;
  XSectionMap[130.5]=16.00218;
  XSectionMap[131]=15.87639;
  XSectionMap[131.5]=15.75971;
  XSectionMap[132]=15.63414;
  XSectionMap[132.5]=15.50779;
  XSectionMap[133]=15.39265;
  XSectionMap[133.5]=15.26662;
  XSectionMap[134]=15.1617;
  XSectionMap[134.5]=15.047;
  XSectionMap[135]=14.9324;
  XSectionMap[135.5]=14.81791;
  XSectionMap[136]=14.70354;
  XSectionMap[136.5]=14.58927;
  XSectionMap[137]=14.47532;
  XSectionMap[137.5]=14.38228;
  XSectionMap[138]=14.26845;
  XSectionMap[138.5]=14.15482;
  XSectionMap[139]=14.05231;
  XSectionMap[139.5]=13.94891;
  XSectionMap[140]=13.84562;
  XSectionMap[141]=13.64057;
  XSectionMap[142]=13.44507;
  XSectionMap[143]=13.24;
  XSectionMap[144]=13.05526;
  XSectionMap[145]=12.86195;
  XSectionMap[146]=12.68876;
  XSectionMap[147]=12.5064;
  XSectionMap[148]=12.32437;
  XSectionMap[149]=12.15286;
  XSectionMap[150]=11.98179;
  XSectionMap[151]=11.82075;
  XSectionMap[152]=11.64993;
  XSectionMap[153]=11.48934;
  XSectionMap[154]=11.33298;
  XSectionMap[155]=11.17384;
  XSectionMap[156]=11.01263;
  XSectionMap[157]=10.85104;
  XSectionMap[158]=10.68418;
  XSectionMap[159]=10.52334;
  XSectionMap[160]=10.36062;
  XSectionMap[162]=10.02523;
  XSectionMap[164]=9.69762;
  XSectionMap[166]=9.39728;
  XSectionMap[168]=9.1301;
  XSectionMap[170]=8.87739;
  XSectionMap[172]=8.63504;
  XSectionMap[174]=8.40245;
  XSectionMap[176]=8.17764;
  XSectionMap[178]=7.96305;
  XSectionMap[180]=7.75479;
  XSectionMap[182]=7.54702;
  XSectionMap[184]=7.35255;
  XSectionMap[186]=7.16541;
  XSectionMap[188]=6.98324;
  XSectionMap[190]=6.80952;
  XSectionMap[192]=6.64487;
  XSectionMap[194]=6.49068;
  XSectionMap[196]=6.34284;
  XSectionMap[198]=6.20153;
  XSectionMap[200]=6.06875;
  XSectionMap[202]=5.93861;
  XSectionMap[204]=5.81288;
  XSectionMap[206]=5.69375;
  XSectionMap[208]=5.57598;
  XSectionMap[210]=5.46177;
  XSectionMap[212]=5.35397;
  XSectionMap[214]=5.24869;
  XSectionMap[216]=5.14975;
  XSectionMap[218]=5.05121;
  XSectionMap[220]=4.95707;
  XSectionMap[222]=4.86323;
  XSectionMap[224]=4.77178;
  XSectionMap[226]=4.68459;
  XSectionMap[228]=4.59966;
  XSectionMap[230]=4.51619;
  XSectionMap[232]=4.43594;
  XSectionMap[234]=4.35701;
  XSectionMap[236]=4.28231;
  XSectionMap[238]=4.20786;
  XSectionMap[240]=4.135713;
  XSectionMap[242]=4.067887;
  XSectionMap[244]=4.003181;
  XSectionMap[246]=3.939776;
  XSectionMap[248]=3.87848;
  XSectionMap[250]=3.819473;

  for (std::map<double, double>::const_iterator iter = XSectionMap.begin();  iter != XSectionMap.end(); ++iter) {
    if (mass==iter->first) return iter->second;
    if (mass>iter->first) {
      double lowmass = iter->first;
      double lowxsec = iter->second;
      ++iter;
      if (mass<iter->first) {
        double highmass = iter->first;
        double highxsec = iter->second;
        double xsec = (highxsec-lowxsec)/(highmass-lowmass)*(mass-lowmass)+lowxsec;
        return xsec;
      }
      --iter;
    }
  }

  std::cout << "Warning cross section outside range of 90-250GeV!!!!" << std::endl;
  exit(1);

}

double GetXsection(double mass, TString HistName) {

  map <double, double> XSectionMap;
  if (HistName.Contains("ggh")) {
    XSectionMap[90.0]=29.47; 	
    XSectionMap[95.0]=26.58; 	
    XSectionMap[100.0]=24.02; 	
    XSectionMap[105.0]=21.78; 	
    XSectionMap[110.0]=19.84; 	
    XSectionMap[110.5]=19.65; 	
    XSectionMap[111.0]=19.48; 	
    XSectionMap[111.5]=19.30; 	
    XSectionMap[112.0]=19.13; 	
    XSectionMap[112.5]=18.95; 	
    XSectionMap[113.0]=18.79; 	
    XSectionMap[113.5]=18.62; 	
    XSectionMap[114.0]=18.45; 	
    XSectionMap[114.5]=18.29; 	
    XSectionMap[115.0]=18.13; 	
    XSectionMap[115.5]=17.97; 	
    XSectionMap[116.0]=17.82; 	
    XSectionMap[116.5]=17.66; 	
    XSectionMap[117.0]=17.51; 	
    XSectionMap[117.5]=17.36; 	
    XSectionMap[118.0]=17.21; 	
    XSectionMap[118.5]=17.06; 	
    XSectionMap[119.0]=16.92; 	
    XSectionMap[119.5]=16.78; 	
    XSectionMap[120.0]=16.63; 	
    XSectionMap[120.5]=16.49; 	
    XSectionMap[121.0]=16.36; 	
    XSectionMap[121.5]=16.22; 	
    XSectionMap[122.0]=16.08; 	
    XSectionMap[122.5]=15.94; 	
    XSectionMap[123.0]=15.82; 	
    XSectionMap[123.5]=15.69; 	
    XSectionMap[124.0]=15.56; 	
    XSectionMap[124.5]=15.43; 	
    XSectionMap[125.0]=15.31; 	
    XSectionMap[125.5]=15.18; 	
    XSectionMap[126.0]=15.06; 	
    XSectionMap[126.5]=14.94; 	
    XSectionMap[127.0]=14.82; 	
    XSectionMap[127.5]=14.70; 	
    XSectionMap[128.0]=14.58; 	
    XSectionMap[128.5]=14.46; 	
    XSectionMap[129.0]=14.35; 	
    XSectionMap[129.5]=14.23; 	
    XSectionMap[130.0]=14.12; 	
    XSectionMap[130.5]=14.01; 	
    XSectionMap[131.0]=13.90; 	
    XSectionMap[131.5]=13.80; 	
    XSectionMap[132.0]=13.69; 	
    XSectionMap[132.5]=13.58; 	
    XSectionMap[133.0]=13.48; 	
    XSectionMap[133.5]=13.37; 	
    XSectionMap[134.0]=13.28; 	
    XSectionMap[134.5]=13.18; 	
    XSectionMap[135.0]=13.08; 	
    XSectionMap[135.5]=12.98; 	
    XSectionMap[136.0]=12.88; 	
    XSectionMap[136.5]=12.78; 	
    XSectionMap[137.0]=12.68; 	
    XSectionMap[137.5]=12.60; 	
    XSectionMap[138.0]=12.50; 	
    XSectionMap[138.5]=12.40; 	
    XSectionMap[139.0]=12.31; 	
    XSectionMap[139.5]=12.22; 	
    XSectionMap[140.0]=12.13; 	
    XSectionMap[141.0]=11.95; 	
    XSectionMap[142.0]=11.78; 	
    XSectionMap[143.0]=11.60; 	
    XSectionMap[144.0]=11.44; 	
    XSectionMap[145.0]=11.27; 	
    XSectionMap[146.0]=11.12; 	
    XSectionMap[147.0]=10.96; 	
    XSectionMap[148.0]=10.80; 	
    XSectionMap[149.0]=10.65; 	
    XSectionMap[150.0]=10.50; 	
    XSectionMap[151.0]=10.36; 	
    XSectionMap[152.0]=10.21; 	
    XSectionMap[153.0]=10.07; 	
    XSectionMap[154.0]=9.934; 	
    XSectionMap[155.0]=9.795; 	
    XSectionMap[156.0]=9.655; 	
    XSectionMap[157.0]=9.514; 	
    XSectionMap[158.0]=9.367; 	
    XSectionMap[159.0]=9.225; 	
    XSectionMap[160.0]=9.080; 	
    XSectionMap[162.0]=8.770; 	
    XSectionMap[164.0]=8.465; 	
    XSectionMap[166.0]=8.190; 	
    XSectionMap[168.0]=7.952; 	
    XSectionMap[170.0]=7.729; 	
    XSectionMap[172.0]=7.515; 	
    XSectionMap[174.0]=7.310; 	
    XSectionMap[176.0]=7.112; 	
    XSectionMap[178.0]=6.923; 	
    XSectionMap[180.0]=6.739; 	
    XSectionMap[182.0]=6.553; 	
    XSectionMap[184.0]=6.379; 	
    XSectionMap[186.0]=6.212; 	
    XSectionMap[188.0]=6.050; 	
    XSectionMap[190.0]=5.896; 	
    XSectionMap[192.0]=5.751; 	
    XSectionMap[194.0]=5.616; 	
    XSectionMap[196.0]=5.487; 	
    XSectionMap[198.0]=5.364; 	
    XSectionMap[200.0]=5.249; 	
    XSectionMap[202.0]=5.136; 	
    XSectionMap[204.0]=5.027; 	
    XSectionMap[206.0]=4.924; 	
    XSectionMap[208.0]=4.822; 	
    XSectionMap[210.0]=4.723; 	
    XSectionMap[212.0]=4.630; 	
    XSectionMap[214.0]=4.539; 	
    XSectionMap[216.0]=4.454; 	
    XSectionMap[218.0]=4.369; 	
    XSectionMap[220.0]=4.288; 	
    XSectionMap[222.0]=4.207; 	
    XSectionMap[224.0]=4.128; 	
    XSectionMap[226.0]=4.053; 	
    XSectionMap[228.0]=3.980; 	
    XSectionMap[230.0]=3.908; 	
    XSectionMap[232.0]=3.839; 	
    XSectionMap[234.0]=3.771; 	
    XSectionMap[236.0]=3.707; 	
    XSectionMap[238.0]=3.643; 	
    XSectionMap[240.0]=3.581; 	
    XSectionMap[242.0]=3.523; 	
    XSectionMap[244.0]=3.468; 	
    XSectionMap[246.0]=3.414; 	
    XSectionMap[248.0]=3.362; 	
    XSectionMap[250.0]=3.312; 	
    XSectionMap[252.0]=3.261; 	
    XSectionMap[254.0]=3.212; 	
    XSectionMap[256.0]=3.164; 	
    XSectionMap[258.0]=3.118; 	
    XSectionMap[260.0]=3.072; 	
    XSectionMap[262.0]=3.028; 	
    XSectionMap[264.0]=2.984; 	
    XSectionMap[266.0]=2.944; 	
    XSectionMap[268.0]=2.903; 	
    XSectionMap[270.0]=2.864; 	
    XSectionMap[272.0]=2.828; 	
    XSectionMap[274.0]=2.793; 	
    XSectionMap[276.0]=2.760; 	
    XSectionMap[278.0]=2.728; 	
    XSectionMap[280.0]=2.696; 	
    XSectionMap[282.0]=2.664; 	
    XSectionMap[284.0]=2.633; 	
    XSectionMap[286.0]=2.603; 	
    XSectionMap[288.0]=2.574; 	
    XSectionMap[290.0]=2.546; 	
    XSectionMap[295.0]=2.480; 	
    XSectionMap[300.0]=2.422; 	
    XSectionMap[305.0]=2.369; 	
    XSectionMap[310.0]=2.322; 	
    XSectionMap[315.0]=2.281; 	
    XSectionMap[320.0]=2.247; 	
    XSectionMap[325.0]=2.221; 	
    XSectionMap[330.0]=2.204; 	
    XSectionMap[335.0]=2.195; 	
    XSectionMap[340.0]=2.198; 	
    XSectionMap[345.0]=2.225; 	
    XSectionMap[350.0]=2.306; 	
    XSectionMap[360.0]=2.361; 	
    XSectionMap[370.0]=2.341; 	
    XSectionMap[380.0]=2.266; 	
    XSectionMap[390.0]=2.158; 	
    XSectionMap[400.0]=2.032; 	
    XSectionMap[420.0]=1.756; 	
    XSectionMap[440.0]=1.482; 	
    XSectionMap[460.0]=1.237; 	
    XSectionMap[480.0]=1.026; 	
    XSectionMap[500.0]=0.8491; 	
    XSectionMap[520.0]=0.7006; 	
    XSectionMap[540.0]=0.5782; 	
    XSectionMap[560.0]=0.4771; 	
    XSectionMap[580.0]=0.3944; 	
    XSectionMap[600.0]=0.3267; 	
    XSectionMap[620.0]=0.2713; 	
    XSectionMap[640.0]=0.2257; 	
    XSectionMap[660.0]=0.1883; 	
    XSectionMap[680.0]=0.1574; 	
    XSectionMap[700.0]=0.1320; 	
    XSectionMap[720.0]=0.1109; 	
    XSectionMap[740.0]=0.09335; 
    XSectionMap[760.0]=0.07883; 
    XSectionMap[780.0]=0.06668; 
    XSectionMap[800.0]=0.05655; 
    XSectionMap[820.0]=0.04806; 
    XSectionMap[840.0]=0.04089; 
    XSectionMap[860.0]=0.03490; 
    XSectionMap[880.0]=0.02982; 
    XSectionMap[900.0]=0.02555; 
    XSectionMap[920.0]=0.02193; 
    XSectionMap[940.0]=0.01885; 
    XSectionMap[960.0]=0.01624; 
    XSectionMap[980.0]=0.01400; 
    XSectionMap[1000.0]=0.01210;  
  } else if (HistName.Contains("vbf")) {
    XSectionMap[90.0]=1.710; 	
    XSectionMap[95.0]=1.628; 	
    XSectionMap[100.0]=1.546; 	
    XSectionMap[105.0]=1.472; 	
    XSectionMap[110.0]=1.398; 	
    XSectionMap[110.5]=1.391; 	
    XSectionMap[111.0]=1.384; 	
    XSectionMap[111.5]=1.378; 	
    XSectionMap[112.0]=1.371; 	
    XSectionMap[112.5]=1.364; 	
    XSectionMap[113.0]=1.358; 	
    XSectionMap[113.5]=1.351; 	
    XSectionMap[114.0]=1.345; 	
    XSectionMap[114.5]=1.339; 	
    XSectionMap[115.0]=1.332; 	
    XSectionMap[115.5]=1.326; 	
    XSectionMap[116.0]=1.319; 	
    XSectionMap[116.5]=1.313; 	
    XSectionMap[117.0]=1.307; 	
    XSectionMap[117.5]=1.300; 	
    XSectionMap[118.0]=1.294; 	
    XSectionMap[118.5]=1.288; 	
    XSectionMap[119.0]=1.282; 	
    XSectionMap[119.5]=1.276; 	
    XSectionMap[120.0]=1.269; 	
    XSectionMap[120.5]=1.263; 	
    XSectionMap[121.0]=1.257; 	
    XSectionMap[121.5]=1.251; 	
    XSectionMap[122.0]=1.246; 	
    XSectionMap[122.5]=1.240; 	
    XSectionMap[123.0]=1.234; 	
    XSectionMap[123.5]=1.228; 	
    XSectionMap[124.0]=1.222; 	
    XSectionMap[124.5]=1.216; 	
    XSectionMap[125.0]=1.211; 	
    XSectionMap[125.5]=1.205; 	
    XSectionMap[126.0]=1.199; 	
    XSectionMap[126.5]=1.193; 	
    XSectionMap[127.0]=1.188; 	
    XSectionMap[127.5]=1.182; 	
    XSectionMap[128.0]=1.176; 	
    XSectionMap[128.5]=1.171; 	
    XSectionMap[129.0]=1.165; 	
    XSectionMap[129.5]=1.159; 	
    XSectionMap[130.0]=1.154; 	
    XSectionMap[130.5]=1.148; 	
    XSectionMap[131.0]=1.143; 	
    XSectionMap[131.5]=1.137; 	
    XSectionMap[132.0]=1.132; 	
    XSectionMap[132.5]=1.126; 	
    XSectionMap[133.0]=1.121; 	
    XSectionMap[133.5]=1.115; 	
    XSectionMap[134.0]=1.110; 	
    XSectionMap[134.5]=1.105; 	
    XSectionMap[135.0]=1.100; 	
    XSectionMap[135.5]=1.095; 	
    XSectionMap[136.0]=1.090; 	
    XSectionMap[136.5]=1.085; 	
    XSectionMap[137.0]=1.080; 	
    XSectionMap[137.5]=1.076; 	
    XSectionMap[138.0]=1.071; 	
    XSectionMap[138.5]=1.066; 	
    XSectionMap[139.0]=1.062; 	
    XSectionMap[139.5]=1.057; 	
    XSectionMap[140.0]=1.052; 	
    XSectionMap[141.0]=1.043; 	
    XSectionMap[142.0]=1.033; 	
    XSectionMap[143.0]=1.023; 	
    XSectionMap[144.0]=1.013; 	
    XSectionMap[145.0]=1.004; 	
    XSectionMap[146.0]=0.9951; 	
    XSectionMap[147.0]=0.9866; 	
    XSectionMap[148.0]=0.9782; 	
    XSectionMap[149.0]=0.9699; 	
    XSectionMap[150.0]=0.9617; 	
    XSectionMap[151.0]=0.9529; 	
    XSectionMap[152.0]=0.9441; 	
    XSectionMap[153.0]=0.9353; 	
    XSectionMap[154.0]=0.9266; 	
    XSectionMap[155.0]=0.9180; 	
    XSectionMap[156.0]=0.9095; 	
    XSectionMap[157.0]=0.9013; 	
    XSectionMap[158.0]=0.8934; 	
    XSectionMap[159.0]=0.8859; 	
    XSectionMap[160.0]=0.8787; 	
    XSectionMap[162.0]=0.8676; 	
    XSectionMap[164.0]=0.8571; 	
    XSectionMap[166.0]=0.8453; 	
    XSectionMap[168.0]=0.8316; 	
    XSectionMap[170.0]=0.8173; 	
    XSectionMap[172.0]=0.8029; 	
    XSectionMap[174.0]=0.7885; 	
    XSectionMap[176.0]=0.7744; 	
    XSectionMap[178.0]=0.7609; 	
    XSectionMap[180.0]=0.7480; 	
    XSectionMap[182.0]=0.7361; 	
    XSectionMap[184.0]=0.7248; 	
    XSectionMap[186.0]=0.7139; 	
    XSectionMap[188.0]=0.7032; 	
    XSectionMap[190.0]=0.6925; 	
    XSectionMap[192.0]=0.6812; 	
    XSectionMap[194.0]=0.6699; 	
    XSectionMap[196.0]=0.6587; 	
    XSectionMap[198.0]=0.6478; 	
    XSectionMap[200.0]=0.6371; 	
    XSectionMap[202.0]=0.6267; 	
    XSectionMap[204.0]=0.6164; 	
    XSectionMap[206.0]=0.6064; 	
    XSectionMap[208.0]=0.5965; 	
    XSectionMap[210.0]=0.5869; 	
    XSectionMap[212.0]=0.5775; 	
    XSectionMap[214.0]=0.5684; 	
    XSectionMap[216.0]=0.5594; 	
    XSectionMap[218.0]=0.5506; 	
    XSectionMap[220.0]=0.5420; 	
    XSectionMap[222.0]=0.5335; 	
    XSectionMap[224.0]=0.5252; 	
    XSectionMap[226.0]=0.5170; 	
    XSectionMap[228.0]=0.5089; 	
    XSectionMap[230.0]=0.5011; 	
    XSectionMap[232.0]=0.4934; 	
    XSectionMap[234.0]=0.4859; 	
    XSectionMap[236.0]=0.4785; 	
    XSectionMap[238.0]=0.4712; 	
    XSectionMap[240.0]=0.4641; 	
    XSectionMap[242.0]=0.4572; 	
    XSectionMap[244.0]=0.4503; 	
    XSectionMap[246.0]=0.4436; 	
    XSectionMap[248.0]=0.4369; 	
    XSectionMap[250.0]=0.4304; 	
    XSectionMap[252.0]=0.4239; 	
    XSectionMap[254.0]=0.4174; 	
    XSectionMap[256.0]=0.4111; 	
    XSectionMap[258.0]=0.4049; 	
    XSectionMap[260.0]=0.3988; 	
    XSectionMap[262.0]=0.3931; 	
    XSectionMap[264.0]=0.3875; 	
    XSectionMap[266.0]=0.3821; 	
    XSectionMap[268.0]=0.3767; 	
    XSectionMap[270.0]=0.3715; 	
    XSectionMap[272.0]=0.3663; 	
    XSectionMap[274.0]=0.3611; 	
    XSectionMap[276.0]=0.3560; 	
    XSectionMap[278.0]=0.3510; 	
    XSectionMap[280.0]=0.3461; 	
    XSectionMap[282.0]=0.3413; 	
    XSectionMap[284.0]=0.3365; 	
    XSectionMap[286.0]=0.3318; 	
    XSectionMap[288.0]=0.3271; 	
    XSectionMap[290.0]=0.3226; 	
    XSectionMap[295.0]=0.3116; 	
    XSectionMap[300.0]=0.3011; 	
    XSectionMap[305.0]=0.2908; 	
    XSectionMap[310.0]=0.2809; 	
    XSectionMap[315.0]=0.2716; 	
    XSectionMap[320.0]=0.2627; 	
    XSectionMap[325.0]=0.2539; 	
    XSectionMap[330.0]=0.2453; 	
    XSectionMap[335.0]=0.2368; 	
    XSectionMap[340.0]=0.2286; 	
    XSectionMap[345.0]=0.2206; 	
    XSectionMap[350.0]=0.2132; 	
    XSectionMap[360.0]=0.2018; 	
    XSectionMap[370.0]=0.1910; 	
    XSectionMap[380.0]=0.1808; 	
    XSectionMap[390.0]=0.1712; 	
    XSectionMap[400.0]=0.1620; 	
    XSectionMap[420.0]=0.1451; 	
    XSectionMap[440.0]=0.1304; 	
    XSectionMap[460.0]=0.1171; 	
    XSectionMap[480.0]=0.1054; 	
    XSectionMap[500.0]=0.09497; 
    XSectionMap[520.0]=0.08568; 
    XSectionMap[540.0]=0.07746; 
    XSectionMap[560.0]=0.07010; 
    XSectionMap[580.0]=0.06353; 
    XSectionMap[600.0]=0.05771; 
    XSectionMap[620.0]=0.05246; 
    XSectionMap[640.0]=0.04776; 
    XSectionMap[660.0]=0.04356; 
    XSectionMap[680.0]=0.03977; 
    XSectionMap[700.0]=0.03637; 
    XSectionMap[720.0]=0.03330; 
    XSectionMap[740.0]=0.03052; 
    XSectionMap[760.0]=0.02805; 
    XSectionMap[780.0]=0.02580; 
    XSectionMap[800.0]=0.02373; 
    XSectionMap[820.0]=0.02188; 
    XSectionMap[840.0]=0.02018; 
    XSectionMap[860.0]=0.01864; 
    XSectionMap[880.0]=0.01724; 
    XSectionMap[900.0]=0.01597; 
    XSectionMap[920.0]=0.01479; 
    XSectionMap[940.0]=0.01375; 
    XSectionMap[960.0]=0.01275; 
    XSectionMap[980.0]=0.01186; 
    XSectionMap[1000.0]=0.01104;
  } else if (HistName.Contains("wzh")) {
    XSectionMap[90]=2.4997;
    XSectionMap[95]=2.1268;
    XSectionMap[100]=1.8173;
    XSectionMap[105]=1.5629;
    XSectionMap[110]=1.3475;
    XSectionMap[110.5]=1.3278;
    XSectionMap[111]=1.3084;
    XSectionMap[111.5]=1.2893;
    XSectionMap[112]=1.2706;
    XSectionMap[112.5]=1.2522;
    XSectionMap[113]=1.2343;
    XSectionMap[113.5]=1.2165;
    XSectionMap[114]=1.1991;
    XSectionMap[114.5]=1.1821;
    XSectionMap[115]=1.1653;
    XSectionMap[115.5]=1.1491;
    XSectionMap[116]=1.1331;
    XSectionMap[116.5]=1.1175;
    XSectionMap[117]=1.1022;
    XSectionMap[117.5]=1.0872;
    XSectionMap[118]=1.0724;
    XSectionMap[118.5]=1.0579;
    XSectionMap[119]=1.0437;
    XSectionMap[119.5]=1.0296;
    XSectionMap[120]=1.0159;
    XSectionMap[120.5]=1.0023;
    XSectionMap[121]=0.9889;
    XSectionMap[121.5]=0.9756;
    XSectionMap[122]=0.9626;
    XSectionMap[122.5]=0.9499;
    XSectionMap[123]=0.9372;
    XSectionMap[123.5]=0.9248;
    XSectionMap[124]=0.9126;
    XSectionMap[124.5]=0.9005;
    XSectionMap[125]=0.8887;
    XSectionMap[125.5]=0.8769;
    XSectionMap[126]=0.8653;
    XSectionMap[126.5]=0.8539;
    XSectionMap[127]=0.8427;
    XSectionMap[127.5]=0.8316;
    XSectionMap[128]=0.8207;
    XSectionMap[128.5]=0.8099;
    XSectionMap[129]=0.7993;
    XSectionMap[129.5]=0.7888;
    XSectionMap[130]=0.7786;
    XSectionMap[130.5]=0.7685;
    XSectionMap[131]=0.7586;
    XSectionMap[131.5]=0.7488;
    XSectionMap[132]=0.7391;
    XSectionMap[132.5]=0.7296;
    XSectionMap[133]=0.7203;
    XSectionMap[133.5]=0.7111;
    XSectionMap[134]=0.702;
    XSectionMap[134.5]=0.6931;
    XSectionMap[135]=0.6843;
    XSectionMap[135.5]=0.6756;
    XSectionMap[136]=0.667;
    XSectionMap[136.5]=0.6585;
    XSectionMap[137]=0.6503;
    XSectionMap[137.5]=0.642;
    XSectionMap[138]=0.6339;
    XSectionMap[138.5]=0.626;
    XSectionMap[139]=0.6182;
    XSectionMap[139.5]=0.6105;
    XSectionMap[140]=0.6029;
    XSectionMap[141]=0.5882;
    XSectionMap[142]=0.574;
    XSectionMap[143]=0.5602;
    XSectionMap[144]=0.5467;
    XSectionMap[145]=0.5336;
    XSectionMap[146]=0.5205;
    XSectionMap[147]=0.5078;
    XSectionMap[148]=0.4953;
    XSectionMap[149]=0.4832;
    XSectionMap[150]=0.4714;
    XSectionMap[151]=0.4602;
    XSectionMap[152]=0.4492;
    XSectionMap[153]=0.4384;
    XSectionMap[154]=0.4277;
    XSectionMap[155]=0.4171;
    XSectionMap[156]=0.4053;
    XSectionMap[157]=0.3938;
    XSectionMap[158]=0.3827;
    XSectionMap[159]=0.3722;
    XSectionMap[160]=0.3625;
    XSectionMap[162]=0.3498;
    XSectionMap[164]=0.3392;
    XSectionMap[166]=0.3271;
    XSectionMap[168]=0.313;
    XSectionMap[170]=0.2989;
    XSectionMap[172]=0.2862;
    XSectionMap[174]=0.2742;
    XSectionMap[176]=0.26262;
    XSectionMap[178]=0.2516;
    XSectionMap[180]=0.24127;
    XSectionMap[182]=0.23239;
    XSectionMap[184]=0.22416;
    XSectionMap[186]=0.21581;
    XSectionMap[188]=0.20718;
    XSectionMap[190]=0.19896;
    XSectionMap[192]=0.19139;
    XSectionMap[194]=0.18426;
    XSectionMap[196]=0.17733;
    XSectionMap[198]=0.1706;
    XSectionMap[200]=0.16416;
    XSectionMap[202]=0.15804;
    XSectionMap[204]=0.15221;
    XSectionMap[206]=0.14665;
    XSectionMap[208]=0.14133;
    XSectionMap[210]=0.13625;
    XSectionMap[212]=0.13135;
    XSectionMap[214]=0.12666;
    XSectionMap[216]=0.12218;
    XSectionMap[218]=0.11788;
    XSectionMap[220]=0.11377;
    XSectionMap[222]=0.10984;
    XSectionMap[224]=0.10607;
    XSectionMap[226]=0.10246;
    XSectionMap[228]=0.09898;
    XSectionMap[230]=0.09566;
    XSectionMap[232]=0.09244;
    XSectionMap[234]=0.08934;
    XSectionMap[236]=0.08635;
    XSectionMap[238]=0.0835;
    XSectionMap[240]=0.08074;
    XSectionMap[242]=0.07809;
    XSectionMap[244]=0.07555;
    XSectionMap[246]=0.0731;
    XSectionMap[248]=0.07075;
    XSectionMap[250]=0.06848;
  } else if (HistName.Contains("tth")) {
    XSectionMap[90.0]=0.2162;
    XSectionMap[95.0]=0.1880; 	
    XSectionMap[100.0]=0.1638; 	
    XSectionMap[105.0]=0.1433; 	
    XSectionMap[110.0]=0.1257; 	
    XSectionMap[110.5]=0.1241; 	
    XSectionMap[111.0]=0.1225; 	
    XSectionMap[111.5]=0.1209; 	
    XSectionMap[112.0]=0.1194; 	
    XSectionMap[112.5]=0.1179; 	
    XSectionMap[113.0]=0.1164; 	
    XSectionMap[113.5]=0.1149; 	
    XSectionMap[114.0]=0.1134; 	
    XSectionMap[114.5]=0.1120; 	
    XSectionMap[115.0]=0.1106; 	
    XSectionMap[115.5]=0.1092; 	
    XSectionMap[116.0]=0.1078; 	
    XSectionMap[116.5]=0.1065; 	
    XSectionMap[117.0]=0.1051; 	
    XSectionMap[117.5]=0.1038; 	
    XSectionMap[118.0]=0.1025; 	
    XSectionMap[118.5]=0.1013; 	
    XSectionMap[119.0]=0.1000; 	
    XSectionMap[119.5]=0.09878; 
    XSectionMap[120.0]=0.09756; 
    XSectionMap[120.5]=0.09636; 
    XSectionMap[121.0]=0.09518; 
    XSectionMap[121.5]=0.09402; 
    XSectionMap[122.0]=0.09287; 
    XSectionMap[122.5]=0.09174; 
    XSectionMap[123.0]=0.09063; 
    XSectionMap[123.5]=0.08954; 
    XSectionMap[124.0]=0.08846; 
    XSectionMap[124.5]=0.08739; 
    XSectionMap[125.0]=0.08634; 
    XSectionMap[125.5]=0.08530; 
    XSectionMap[126.0]=0.08428; 
    XSectionMap[126.5]=0.08327; 
    XSectionMap[127.0]=0.08227; 
    XSectionMap[127.5]=0.08129; 
    XSectionMap[128.0]=0.08032; 
    XSectionMap[128.5]=0.07937; 
    XSectionMap[129.0]=0.07842; 
    XSectionMap[129.5]=0.07750; 
    XSectionMap[130.0]=0.07658; 
    XSectionMap[130.5]=0.07568; 
    XSectionMap[131.0]=0.07479; 
    XSectionMap[131.5]=0.07391; 
    XSectionMap[132.0]=0.07304; 
    XSectionMap[132.5]=0.07219; 
    XSectionMap[133.0]=0.07135; 
    XSectionMap[133.5]=0.07052; 
    XSectionMap[134.0]=0.06970; 
    XSectionMap[134.5]=0.06890; 
    XSectionMap[135.0]=0.06810; 
    XSectionMap[135.5]=0.06731; 
    XSectionMap[136.0]=0.06654; 
    XSectionMap[136.5]=0.06577; 
    XSectionMap[137.0]=0.06502; 
    XSectionMap[137.5]=0.06428; 
    XSectionMap[138.0]=0.06355; 
    XSectionMap[138.5]=0.06282; 
    XSectionMap[139.0]=0.06211; 
    XSectionMap[139.5]=0.06141; 
    XSectionMap[140.0]=0.06072; 
    XSectionMap[141.0]=0.05937; 
    XSectionMap[142.0]=0.05807; 
    XSectionMap[143.0]=0.05680; 
    XSectionMap[144.0]=0.05556; 
    XSectionMap[145.0]=0.05435; 
    XSectionMap[146.0]=0.05316; 
    XSectionMap[147.0]=0.05200; 
    XSectionMap[148.0]=0.05087; 
    XSectionMap[149.0]=0.04976; 
    XSectionMap[150.0]=0.04869; 
    XSectionMap[151.0]=0.04765; 
    XSectionMap[152.0]=0.04663; 
    XSectionMap[153.0]=0.04564; 
    XSectionMap[154.0]=0.04468; 
    XSectionMap[155.0]=0.04374; 
    XSectionMap[156.0]=0.04283; 
    XSectionMap[157.0]=0.04194; 
    XSectionMap[158.0]=0.04108; 
    XSectionMap[159.0]=0.04024; 
    XSectionMap[160.0]=0.03942; 
    XSectionMap[162.0]=0.03783; 
    XSectionMap[164.0]=0.03632; 
    XSectionMap[166.0]=0.03488; 
    XSectionMap[168.0]=0.03350; 
    XSectionMap[170.0]=0.03219; 
    XSectionMap[172.0]=0.03094; 
    XSectionMap[174.0]=0.02975; 
    XSectionMap[176.0]=0.02862; 
    XSectionMap[178.0]=0.02755; 
    XSectionMap[180.0]=0.02652; 
    XSectionMap[182.0]=0.02553; 
    XSectionMap[184.0]=0.02459; 
    XSectionMap[186.0]=0.02370; 
    XSectionMap[188.0]=0.02286; 
    XSectionMap[190.0]=0.02206; 
    XSectionMap[192.0]=0.02128; 
    XSectionMap[194.0]=0.02052; 
    XSectionMap[196.0]=0.01981; 
    XSectionMap[198.0]=0.01913; 
    XSectionMap[200.0]=0.01849; 
    XSectionMap[202.0]=0.01787; 
    XSectionMap[204.0]=0.01727; 
    XSectionMap[206.0]=0.01670; 
    XSectionMap[208.0]=0.01615; 
    XSectionMap[210.0]=0.01562; 
    XSectionMap[212.0]=0.01512; 
    XSectionMap[214.0]=0.01463; 
    XSectionMap[216.0]=0.01417; 
    XSectionMap[218.0]=0.01373; 
    XSectionMap[220.0]=0.01330; 
    XSectionMap[222.0]=0.01289; 
    XSectionMap[224.0]=0.01251; 
    XSectionMap[226.0]=0.01213; 
    XSectionMap[228.0]=0.01178; 
    XSectionMap[230.0]=0.01143; 
    XSectionMap[232.0]=0.01110; 
    XSectionMap[234.0]=0.01077; 
    XSectionMap[236.0]=0.01046; 
    XSectionMap[238.0]=0.01016; 
    XSectionMap[240.0]=0.009873;
    XSectionMap[242.0]=0.009597;
    XSectionMap[244.0]=0.009331;
    XSectionMap[246.0]=0.009076;
    XSectionMap[248.0]=0.008830;
    XSectionMap[250.0]=0.008593;
    XSectionMap[252.0]=0.008363;
    XSectionMap[254.0]=0.008142;
    XSectionMap[256.0]=0.007928;
    XSectionMap[258.0]=0.007722;
    XSectionMap[260.0]=0.007524;
    XSectionMap[262.0]=0.007333;
    XSectionMap[264.0]=0.007149;
    XSectionMap[266.0]=0.006972;
    XSectionMap[268.0]=0.006801;
    XSectionMap[270.0]=0.006636;
    XSectionMap[272.0]=0.006476;
    XSectionMap[274.0]=0.006322;
    XSectionMap[276.0]=0.006173;
    XSectionMap[278.0]=0.006028;
    XSectionMap[280.0]=0.005889;
    XSectionMap[282.0]=0.005754;
    XSectionMap[284.0]=0.005623;
    XSectionMap[286.0]=0.005497;
    XSectionMap[288.0]=0.005374;
    XSectionMap[290.0]=0.005256;
    XSectionMap[295.0]=0.004975;
    XSectionMap[300.0]=0.004719;
  } else {
    std::cout << "Warning ggh, vbf, wzh, or tth not found in histname!!!!" << std::endl;
    exit(1);
  }

  for (std::map<double, double>::const_iterator iter = XSectionMap.begin();  iter != XSectionMap.end(); ++iter) {
    if (mass==iter->first) return iter->second;
    if (mass>iter->first) {
      double lowmass = iter->first;
      double lowxsec = iter->second;
      ++iter;
      if (mass<iter->first) {
        double highmass = iter->first;
        double highxsec = iter->second;
        double xsec = (highxsec-lowxsec)/(highmass-lowmass)*(mass-lowmass)+lowxsec;
        return xsec;
      }
      --iter;
    }
  }

  std::cout << "Warning cross section outside range of 90-250GeV!!!!" << std::endl;
  exit(1);

}

double GetNorm(double mass1, TH1F* hist1, double mass2, TH1F* hist2, double mass) {

  double br = GetBR(mass);
  double br1 = GetBR(mass1);
  double br2 = GetBR(mass2);
  
  double xsec = GetXsection(mass, hist1->GetName());
  double xsec1 = GetXsection(mass1, hist1->GetName());
  double xsec2 = GetXsection(mass2, hist2->GetName());
  
  double alpha = 1.0*(mass-mass1)/(mass2-mass1);
  double effAcc1 = hist1->Integral()/(xsec1*br1);
  double effAcc2 = hist2->Integral()/(xsec2*br2);

  double Normalization = (xsec*br)*(effAcc1 + alpha * (effAcc2 - effAcc1));
  return Normalization;
  
}

void CheckNorm(double Min, double Max, double Step, TString histname="") {

  vector <double> Mass;
  vector <double> BranchingRatio;
  vector <double> XSection;
  for (double i=Min; i<Max; i+=Step) {
    Mass.push_back(i);
    BranchingRatio.push_back(GetBR(i));
    if (histname=="") XSection.push_back(GetXsection(i));
    else XSection.push_back(GetXsection(i,histname));
  }

  TGraph* BranchGraph = new TGraph(Mass.size(),&Mass[0],&BranchingRatio[0]);
  TGraph* XSectionGraph = new TGraph(Mass.size(),&Mass[0],&XSection[0]);
  BranchGraph->SetTitle("Interpolated Branching Ratios");
  XSectionGraph->SetTitle("Interpolated Cross Sections");
  BranchGraph->SetMarkerStyle(20);
  XSectionGraph->SetMarkerStyle(20);
  BranchGraph->SetMarkerSize(1);
  XSectionGraph->SetMarkerSize(1);

  TCanvas* c1 = new TCanvas("c1","c1",800,650);
  c1->cd();
  BranchGraph->Draw("AP");
  c1->SaveAs("BranchingRatios.png");
  c1->Clear();
  XSectionGraph->Draw("AP");
  c1->SaveAs("XSections.png");

  delete BranchGraph;
  delete XSectionGraph;
  delete c1;

}
